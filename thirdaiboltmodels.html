<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>thirdai.bolt.models &mdash; thirdai  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="thirdai.bolt.types" href="thirdaibolttypes.html" />
    <link rel="prev" title="thirdai.bolt" href="thirdaibolt.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            thirdai
              <img src="_static/thirdai_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="thirdaibase.html">thirdai</a></li>
<li class="toctree-l1"><a class="reference internal" href="thirdaibolt.html">thirdai.bolt</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">thirdai.bolt.models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#thirdai.bolt.models.TabularDatasetFactory"><code class="docutils literal notranslate"><span class="pre">TabularDatasetFactory</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#thirdai.bolt.models.TabularDatasetFactory.get_dataset_loader"><code class="docutils literal notranslate"><span class="pre">TabularDatasetFactory.get_dataset_loader()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#thirdai.bolt.models.UDTGenerator"><code class="docutils literal notranslate"><span class="pre">UDTGenerator</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#thirdai.bolt.models.UDTGenerator.__init__"><code class="docutils literal notranslate"><span class="pre">UDTGenerator.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#thirdai.bolt.models.UDTGenerator.evaluate"><code class="docutils literal notranslate"><span class="pre">UDTGenerator.evaluate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#thirdai.bolt.models.UDTGenerator.predict"><code class="docutils literal notranslate"><span class="pre">UDTGenerator.predict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#thirdai.bolt.models.UDTGenerator.predict_batch"><code class="docutils literal notranslate"><span class="pre">UDTGenerator.predict_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#thirdai.bolt.models.UDTGenerator.save"><code class="docutils literal notranslate"><span class="pre">UDTGenerator.save()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#thirdai.bolt.models.UDTGenerator.train"><code class="docutils literal notranslate"><span class="pre">UDTGenerator.train()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#thirdai.bolt.models.UDTTextClassifier"><code class="docutils literal notranslate"><span class="pre">UDTTextClassifier</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#thirdai.bolt.models.UDTTextClassifier.predict"><code class="docutils literal notranslate"><span class="pre">UDTTextClassifier.predict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#thirdai.bolt.models.UDTTextClassifier.save"><code class="docutils literal notranslate"><span class="pre">UDTTextClassifier.save()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#thirdai.bolt.models.UDTTextClassifier.train"><code class="docutils literal notranslate"><span class="pre">UDTTextClassifier.train()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#thirdai.bolt.models.UDTTextClassifier.validate"><code class="docutils literal notranslate"><span class="pre">UDTTextClassifier.validate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="thirdaibolttypes.html">thirdai.bolt.types</a></li>
<li class="toctree-l1"><a class="reference internal" href="thirdaibolttemporal.html">thirdai.bolt.temporal</a></li>
<li class="toctree-l1"><a class="reference internal" href="thirdaiboltcallbacks.html">thirdai.bolt.callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="thirdaidataset.html">thirdai.dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="thirdaidata.html">thirdai.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="thirdailog.html">thirdai.logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="thirdailicensing.html">thirdai.licensing</a></li>
<li class="toctree-l1"><a class="reference internal" href="thirdaisearch.html">thirdai.search</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">thirdai</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">thirdai.bolt.models</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/thirdaiboltmodels.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-thirdai.bolt.models">
<span id="thirdai-bolt-models"></span><h1>thirdai.bolt.models<a class="headerlink" href="#module-thirdai.bolt.models" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="thirdai.bolt.models.TabularDatasetFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thirdai.bolt.models.</span></span><span class="sig-name descname"><span class="pre">TabularDatasetFactory</span></span><a class="headerlink" href="#thirdai.bolt.models.TabularDatasetFactory" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="thirdai.bolt.models.TabularDatasetFactory.get_dataset_loader">
<span class="sig-name descname"><span class="pre">get_dataset_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="thirdaidataset.html#thirdai.dataset.DataSource" title="thirdai.dataset.DataSource"><span class="pre">dataset.DataSource</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dataset.DatasetLoader</span></span></span><a class="headerlink" href="#thirdai.bolt.models.TabularDatasetFactory.get_dataset_loader" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thirdai.bolt.models.UDTGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thirdai.bolt.models.</span></span><span class="sig-name descname"><span class="pre">UDTGenerator</span></span><a class="headerlink" href="#thirdai.bolt.models.UDTGenerator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="thirdai.bolt.models.UDTGenerator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">','</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#thirdai.bolt.models.UDTGenerator.__init__" title="Permalink to this definition"></a></dt>
<dd><p>UniversalDeepTransformer (UDT) Constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_column</strong> (<em>str</em>) – Optional. Column name specifying the source queries in the input
dataset. If provided then the model can use these queries to augment its training.
If not provided then the model be trained from the target queries directly. If the
source column is specified the the model can be trained with in both a supervised
setting where (incorrect query, correct query) pairs are provided and in an
unsupervised setting where only correct queries are provided. If source is not specified
then it can only be trained in an unsupervised setting.</p></li>
<li><p><strong>target_column</strong> (<em>str</em>) – Column name specifying the target queries in the input dataset.
Queries in this column are the target that the UDT model learns to predict.</p></li>
<li><p><strong>dataset_size</strong> (<em>str</em>) – <p>The size of the input dataset. This size factor informs what
UDT model to create.</p>
<p>The dataset size can be one of the following:
- small
- medium
- large</p>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Suppose we have an input CSV dataset consisting of grammatically or syntactically</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># incorrect queries that we want to reformulate. We will assume that the dataset also</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># has a target correct query for each incorrect query. We can initialize a UDT model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># for query reformulation as follows:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">bolt</span><span class="o">.</span><span class="n">UniversalDeepTransformer</span><span class="p">(</span>
<span class="go">        target_column=&quot;queries_for_prediction&quot;,</span>
<span class="go">        source_column=&quot;incorrect_queries&quot;,</span>
<span class="go">        dataset_size=&quot;medium&quot;</span>
<span class="go">    )</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thirdai.bolt.models.UDTGenerator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">object</span></span></span><a class="headerlink" href="#thirdai.bolt.models.UDTGenerator.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Evaluates the UniversalDeepTransformer (UDT) model on the given dataset and returns
a list of generated queries as reformulations of the incorrect queries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – Path to the dataset file</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – The number of candidate query reformulations suggested by the UDT model.
The default value for k is 5.</p></li>
<li><p><strong>return_scores</strong> (<em>bool</em>) – Whether or not to return the scores for the reformulations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple(List[List[str]]) or Tuple(List[List[str]], List[List[str]])
Returns a tuple of list of k reformulations for each incorrect query to be
reformulated in the input dataset. If return_scores is True, also returns
the corresponding scores for the reformulations.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If the input dataset file contains pairs of correct and incorrect queries, this</p></li>
</ul>
<blockquote>
<div><p>method will also print out the recall value at k.</p>
</div></blockquote>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">bolt</span><span class="o">.</span><span class="n">UniversalDeepTransformer</span><span class="p">(</span>
<span class="go">        target_column_index=0,</span>
<span class="go">        source_column_index=1,</span>
<span class="go">        dataset_size=&quot;medium&quot;</span>
<span class="go">    )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;./train_file&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reformulated_queries</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;./test_file&quot;</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thirdai.bolt.models.UDTGenerator.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">object</span></span></span><a class="headerlink" href="#thirdai.bolt.models.UDTGenerator.predict" title="Permalink to this definition"></a></dt>
<dd><p>Performs inference on a single sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_query</strong> (<em>str</em>) – The input query as a string.</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – The number of candidate query reformulations suggested by the UDT model
for this input. The default value for k is 5.</p></li>
<li><p><strong>return_scores</strong> (<em>bool</em>) – Whether or not to return the scores for the reformulations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple(List[List[str]]) or Tuple(List[List[str]], List[List[str]])
Returns a tuple of list of k reformulations for each incorrect query to be
reformulated in the input dataset. If return_scores is True, also returns
the corresponding scores for the reformulations.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">bolt</span><span class="o">.</span><span class="n">UniversalDeepTransformer</span><span class="p">(</span>
<span class="go">        target_column_index=0,</span>
<span class="go">        source_column_index=1,</span>
<span class="go">        dataset_size=&quot;medium&quot;</span>
<span class="go">    )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;./train_file&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">udt_refomulation_suggestions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_query</span><span class="o">=</span><span class="s2">&quot;sample query&quot;</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thirdai.bolt.models.UDTGenerator.predict_batch">
<span class="sig-name descname"><span class="pre">predict_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">object</span></span></span><a class="headerlink" href="#thirdai.bolt.models.UDTGenerator.predict_batch" title="Permalink to this definition"></a></dt>
<dd><p>Performs inference on a batch of sammples in parallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_queries</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – A list of target queries to be reformulated.</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – The number of candidate query reformulations suggested by the UDT model
for this input batch. The default value for k is 5.</p></li>
<li><p><strong>return_scores</strong> (<em>bool</em>) – Whether or not to return the scores for the reformulations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple(List[List[str]]) or Tuple(List[List[str]], List[List[str]])
Returns a tuple of list of k reformulations for each incorrect query to be
reformulated in the input dataset. If return_scores is True, also returns
the corresponding scores for the reformulations.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_queries</span> <span class="o">=</span> <span class="c1"># An arbitrary list of incorrect queries.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">bolt</span><span class="o">.</span><span class="n">UniversalDeepTransformer</span><span class="p">(</span>
<span class="go">        target_column_index=0,</span>
<span class="go">        source_column_index=1,</span>
<span class="go">        dataset_size=&quot;medium&quot;</span>
<span class="go">    )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;./train_file&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">udt_refomulation_suggestions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_queries</span><span class="o">=</span><span class="n">input_queries</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thirdai.bolt.models.UDTGenerator.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#thirdai.bolt.models.UDTGenerator.save" title="Permalink to this definition"></a></dt>
<dd><p>Serializes an instance of UDTGenerator to a file on disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The file on disk to serialize in which the instance of
UDTGenerator is to be serialized.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;udt_savefile.bolt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thirdai.bolt.models.UDTGenerator.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_supervised</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#thirdai.bolt.models.UDTGenerator.train" title="Permalink to this definition"></a></dt>
<dd><p>Trains a UniversalDeepTransformer (UDT) model for query reformulation on a given dataset
using a file on disk. The filename must contain at least 1 column containing the target
queries. If a source column (specified when the model was constructed) is present
then the model is additionally trained in a supervised setting using the (source, target) pairs,
(beyond just self supervised (target, target) pairs).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – Path to the dataset file.</p></li>
<li><p><strong>use_supervised</strong> (<em>bool</em>) – Whether to try to use an additional “source” query
column to do supervised training if the column is present. Defaults to
true. If a “source” column is not present, this is a NOOP.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">bolt</span><span class="o">.</span><span class="n">UniversalDeepTransformer</span><span class="p">(</span>
<span class="go">        target_column_index=0,</span>
<span class="go">        source_column_index=1,</span>
<span class="go">        dataset_size=&quot;medium&quot;</span>
<span class="go">    )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;./train_file&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><dl class="simple">
<dt>The UDT model expects different training inputs for query reformulation versus</dt><dd><p>other machine learning tasks.</p>
</dd>
</dl>
</li>
</ul>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thirdai.bolt.models.UDTTextClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thirdai.bolt.models.</span></span><span class="sig-name descname"><span class="pre">UDTTextClassifier</span></span><a class="headerlink" href="#thirdai.bolt.models.UDTTextClassifier" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="thirdai.bolt.models.UDTTextClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#thirdai.bolt.models.UDTTextClassifier.predict" title="Permalink to this definition"></a></dt>
<dd><p>Returns the predicted scores for the model for each output class for each sample
in the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Dict</em>) – A dictionary containing the input data. This should contain the
following fields. Two fields contain the bert tokens for each sample in
the batch in CSR format. The field “tokens” should be a flattened numpy
array of uint32 of all the tokens. The field “offsets” is a numpy array
of uint32 of length (batch_size + 1) that gives the offsets of the tokens
for each document. The tokens for document i should be in the range [offsets[i],
offsets[i+1]) in the tokens array. The field “metadata” should be a 2D numpy
array of 0/1 values (dtype is uint32) that represent the metadata for each
document.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D numpy array with dtype float32 and shape (batch_size, n_classes) which
contains the predicted scores from the model for the given input samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thirdai.bolt.models.UDTTextClassifier.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#thirdai.bolt.models.UDTTextClassifier.save" title="Permalink to this definition"></a></dt>
<dd><p>Saves the model in a binary archive with the given filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The location to save the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thirdai.bolt.models.UDTTextClassifier.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#thirdai.bolt.models.UDTTextClassifier.train" title="Permalink to this definition"></a></dt>
<dd><p>Trains the model for a single input batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Dict</em>) – A dictionary containing the input data. This should contain the
following fields. Two fields contain the bert tokens for each sample in
the batch in CSR format. The field “tokens” should be a flattened numpy
array of uint32 of all the tokens. The field “offsets” is a numpy array
of uint32 of length (batch_size + 1) that gives the offsets of the tokens
for each document. The tokens for document i should be in the range [offsets[i],
offsets[i+1]) in the tokens array. The field “metadata” should be a 2D numpy
array of 0/1 values (dtype is uint32) that represent the metadata for each
document.</p></li>
<li><p><strong>labels</strong> (<em>np.ndarray</em>) – A 2D numpy array of type float32. The shape should be
(batch_size, n_classes) and the label values should be 0/1.</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em>) – The learning rate to use for updating the model for the
given batch.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The mean cross entropy loss over all the output classes in the batch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thirdai.bolt.models.UDTTextClassifier.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#thirdai.bolt.models.UDTTextClassifier.validate" title="Permalink to this definition"></a></dt>
<dd><p>Evaluates the model on a single input batch and returns the loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Dict</em>) – A dictionary containing the input data. This should contain the
following fields. Two fields contain the bert tokens for each sample in
the batch in CSR format. The field “tokens” should be a flattened numpy
array of uint32 of all the tokens. The field “offsets” is a numpy array
of uint32 of length (batch_size + 1) that gives the offsets of the tokens
for each document. The tokens for document i should be in the range [offsets[i],
offsets[i+1]) in the tokens array. The field “metadata” should be a 2D numpy
array of 0/1 values (dtype is uint32) that represent the metadata for each
document.</p></li>
<li><p><strong>labels</strong> (<em>np.ndarray</em>) – A 2D numpy array of type float32. The shape should be
(batch_size, n_classes) and the label values should be 0/1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the mean cross entropy loss over all the output classes
and the cross entropy loss for each output class individually.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="thirdaibolt.html" class="btn btn-neutral float-left" title="thirdai.bolt" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="thirdaibolttypes.html" class="btn btn-neutral float-right" title="thirdai.bolt.types" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, t.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>